% Problem description


\chapter{Introducing Zimbra High Availability}
This thesis was written to reflect the state of the art in High Availability methods for Zimbra Open Source Edition.  

\section {High Availability}
High availability is a system design approach and associated service implementation that ensures that a prearranged level of operational performance will be met during a contractual measurement period.

One of the most common high availability examples are web servers. Two web servers share the same information thanks to a shared storage. If one of the web servers fails to serve pages the other server can reclaim its primary role and shot the other node in the head (stonith) so that it can serve pages instead of the original primary node. The amount of time since the first server failure is detected and when the service is restablished denotes downtime. A contract for High Availability might estipulate that in a month time web servers service might be in downtime status for no more than five minutes.

High Availability, or HA as it is abbreviated, refers to the availability of resources in a computer system, in the event of component failures in the system. This can be achieved in a variety of ways, either with custom and redundant hardware to ensure availability or with software solutions using off-the-shelf hardware components.

The former class of solutions provide a higher degree of availability, but are significantly more expensive than the class. This has led to the popularity of the latter class, with almost all vendors of computer systems offering various HA products. Typically, these products endure single points of failure in the system. (\cite{TaskForceHA})

As an example for more expensive systems we can mention OVH.co.uk web hosting service which uses more than 1,000 servers not only for ensuring high availability but also for dealing with high loads of visitor's queries. SQL servers seem to achieve high availability by using several RAID-1 (mirror) hard disks.

These HA systems usually ensure a prearranged level of operational performance will be met during a contractual measurement period. (\cite{WikipediaHA})

High availability systems typically operate 24x7 and usually require built in redundancy built-in redundancy to minimize the risk of downtime due to hardware and/or telecommunication failures. 

Availability can be measured relative to "100\% operational" or "never failing." A widely-held but difficult-to-achieve standard of availability for a system or product is known as "five 9s" (99.999 percent) availability. (\cite{BCMHA})


\section {Vmware Zimbra OSE}
VMware Zimbra is a complete email, address book, calendar and tasks solution that can be accessed from the Zimbra Web Client, Zimbra Desktop offline client, Outlook and a variety of other standards-based email clients and mobile devices. It can be deployed as a traditional binary install on Linux, or as a software virtual appliance, commonly referred to as Zimbra appliance.

Among the Zimbra Collaboration Server (ZCS) versions this paper will abord the ZCS Open Source Edition also known as Zimbra OSE.

Vmware Zimbra OSE will be refered most of the times as Zimbra.

For more information about Vmware Zimbra you can visit: \cite{ZimbraLearn}.

\section {Vmware Zimbra OSE High Availability}
Zimbra OSE High Availability is a project which attempts to attain high availability to each one of the Zimbra Collaboration Server components so that the risk of downtime due to hardware and/or telecommunication failures is minimized. High availability is usually implemented using High Availability software aimed at Gnu/Linux originally which is adapted to the Zimbra OSE setup.


\section{History}

Prior documentation about Zimbra High Availability was written with Zimbra 6 version in mind which is devoted to work (among others) in Ubuntu 8.04 64 bit. Those instructions were based on Gnu/Linux High Availability software (heartbeat) which is no longer used for High Availability purposes nowadays.

To the best of the author's knowledge there's no updated documentation on how to setup this system.

On September 13th 2012 Vmware announced Zimbra 8 which could be run in Ubuntu 12.04 (\cite{VmwareZimbra8Announce}).

\section {Main thesis topic}
The main thesis of this topic is: \\
\textit{Design and test the setup of a Zimbra 8 High Availability System in Ubuntu 12.04 and write a detailed report of this setup procedure.}

\section {Chosen technologies and solution}
We have decided to use the following proved open source high availability technologies: Corosync, Distributed Replicated Block Device (DRBD), OCF , and Pacemaker.

TODO: Justificarlo con lo de la historia. Haciendo referencia a la secci\'on de Historia. Well known, most used.

Corosync is a software meant to synchronise configuration files. Synchronise configuration files in a cluster is essential because all the cluster members have to share the same information and knowledge of the other cluster members. DRBD allows us to share a common storage between hosts as if a network RAID-1 hard disk it was. Finally, in order to setup and manage the whole cluster we will use Pacemaker cluster which uses OCF scripts as Cluster control scripts.

A set of virtual machines will be setup to check that even with Zimbra 8 and Ubuntu 12.04 all the steps in the original instructions can be reproduced. These steps are: Setup network in both hosts, setup DRBD, initial Pacemaker setup, corosync installation, pacemaker installation, corosync setup, startup script disabling, DRBD script boot disabling, Pacemaker final setup, Pacemaker case of use tests.

\section {Structure of the document}

Chapter 2 explains the high availability system that will be tested through the thesis.

TODO: Chapters 3 to 12 explain the detailed setup procedure of each element that constitutes the final system: \textit{\ref{chap:ha-schema} - High availability schema},
\textit{\ref{chap:operating-system-installation} - Operating System installation},
\textit{\ref{chap:network-setup} - Network setup},
\textit{\ref{chap:zimbra-installation} - Zimbra installation},
\textit{\ref{chap:drbd-setup} - DRBD Setup},
\textit{\ref{chap:corosync-pacemaker-installation} - Corosync and Pacemaker installation},
\textit{\ref{chap:initial-pacemaker-setup} - Initial Pacemaker Setup},
\textit{\ref{chap:corosync-setup} - Corosync Setup},
\textit{\ref{chap:pacemaker-setup} - Pacemaker Setup},
\textit{\ref{chap:zimbra-drbd-startup-script-disabling} - Zimbra and DRBD Startup Script Disabling} and
\textit{\ref{chap:pacemaker-final-setup} - Pacemaker Final Setup} the instructions on how to install and setup a Zimbra OSE High Availability system  with two servers are detailed.

We learn how to manage our new High Availability system thanks to the \textit{\ref{chap:ha-system-management} - High Availability System Management} chapter.

Some of the ways this thesis can be improved are described in chapter \textit{\ref{chap:improvements} - Improvements}.

Finally we can find a summary of the work done during this thesis in \textit{\ref{chap:conclusions} - Conclusions} chapter.

