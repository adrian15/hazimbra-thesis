% OCF


\chapter{Zimbra OCF Resource Agent development}
\label{chap:zimbra-ocf}
This chapter explains the development of a Zimbra OCF Resource Agent.

\section {Introduction}
A resource agent is a standardized interface for a cluster resource. In translates a standard set of operations into steps specific to the resource or application, and interprets their results as success or failure(\cite{ResourceAgentsWiki}). An OCF resource agent is based on the Open Clustering Framework Resource Agent API specifications(\cite{OCFResourceAgentsWiki}).

In order to use latest Pacemaker version to manage Zimbra high availability an OCF Resource Agent script was needed. So a Zimbra OCF Resource Agent was developed.

\section {Development log}
\begin{itemize}
  \item {In order to develop resource agent is advised to have cluster management stopped with:
\begin{verbatim}
service corosync stop
\end{verbatim}
and handle manually the resources on which current script is dependent on.
  }
  \item {It's advised to use \textit{ocf-tester} script which will be find in \textit{cluster-agents} package in order to debug if the OCF script actions complies with the required ones in \cite{OCFResourceAgentsWiki}.
  }
  \item {The minimal required actions were implemented because Zimbra server does not promote or demote itself.
  }
  \item {In order to validate the tests with ocf-tester you can avoid generating valid meta-data XML output. However when using it in production XML output has to be a valid meta-data XML. 
  }
  \item {Default times for waiting to Zimbra service to start or stop were modified to satisfy large (more than 4 minutes) Zimbra start or stop actual times.
  }
\end{itemize}

\section {Zimbra OCF Source code}

You can find Zimbra OCF source code here:

\lstinputlisting[language=Bash]{ocf/zimbra}



